import{_ as t,r as o,o as i,c as p,a as s,b as n,e as a,d as l}from"./app-ff2f727b.js";const c={},u={href:"https://github.com/eryajf/awesome-github-profile-readme-chinese",target:"_blank",rel:"noopener noreferrer"},r=s("p",null,"This article introduces an interesting small action, its main function is to automatically scan the pictures in the warehouse, and then compress them almost losslessly, so that the volume of the entire warehouse is kept at a relatively low level.",-1),d={href:"https://github.com/calibreapp/image-actions",target:"_blank",rel:"noopener noreferrer"},k=l(`<p>Using the configuration is actually very simple, basically after reading the official introduction document you can get started to use, here is one or two things to pay attention to.</p><p>Start by adding the Actions profileï¼Œe.g.Â <code>.github/workflows/images.yml</code>ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> åŽ‹ç¼©å›¾ç‰‡
<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> main
    <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;**.jpg&quot;</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;**.jpeg&quot;</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;**.png&quot;</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;**.webp&quot;</span>
  <span class="token key atrule">workflow_dispatch</span><span class="token punctuation">:</span>
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">build</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> calibreapp/image<span class="token punctuation">-</span>actions
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout Repo
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Compress Images
        <span class="token key atrule">id</span><span class="token punctuation">:</span> calibre
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> calibreapp/image<span class="token punctuation">-</span>actions@main
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">githubToken</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GITHUB_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span>
          <span class="token key atrule">compressOnly</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
          <span class="token key atrule">jpegQuality</span><span class="token punctuation">:</span> <span class="token string">&quot;60&quot;</span>
          <span class="token key atrule">jpegProgressive</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
          <span class="token key atrule">pngQuality</span><span class="token punctuation">:</span> <span class="token string">&quot;60&quot;</span>
          <span class="token key atrule">webpQuality</span><span class="token punctuation">:</span> <span class="token string">&quot;60&quot;</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Create New Pull Request If Needed
        <span class="token key atrule">if</span><span class="token punctuation">:</span> steps.calibre.outputs.markdown <span class="token tag">!=</span> &#39;&#39;
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> peter<span class="token punctuation">-</span>evans/create<span class="token punctuation">-</span>pull<span class="token punctuation">-</span>request@v3
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">title</span><span class="token punctuation">:</span> <span class="token string">&quot;ðŸ›  åŽ‹ç¼©å›¾ç‰‡&quot;</span>
          <span class="token key atrule">branch-suffix</span><span class="token punctuation">:</span> timestamp
          <span class="token key atrule">commit-message</span><span class="token punctuation">:</span> <span class="token string">&quot;ðŸ›  åŽ‹ç¼©å›¾ç‰‡&quot;</span>
          <span class="token key atrule">body</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> steps.calibre.outputs.markdown <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It should be noted that the action of compressing the picture, after running, will automatically commit the picture twice, which requires the action to have the corresponding commit permission, usually the token we configure does not have the permission of the repository after the fork of other developers, so it is not possible to directly deal with the picture in the content of other people&#39;s PR.</p><p>The official advice is:</p><ul><li><p>Either other developers do a PR by checking a branch in the main repository and then branching in the main repository. However, this method is not actually the mainstream scenario of collaboration in GitHub, and is mostly used in the process of personal maintenance of developers.</p></li><li><p>Or first deal with the PR submitted by others through fork, when the PR is approved, it will automatically scan and check, and then after the action completes the image compression, a new PR is automatically created to complete the image compression.</p></li></ul><p>One thing to note is that the <code>secrets. GITHUB_TOKEN</code> is used to operate the current warehouse, and does not need to be changed, if it is changed, an error will be reported.</p><p>The effect is as follows:</p><p><img src="https://cdn.jsdelivr.net/gh/eryajf/tu/img/image_20220801_234434.png" alt="image_20220801_234434"></p><p>This action will automatically process the image and submit it to the current PR, we can click View diff to see the difference before and after:</p><p><img src="https://cdn.jsdelivr.net/gh/eryajf/tu/img/image_20220801_234504.png" alt="image_20220801_234504"></p><p>At present, according to my personal zoomed in on the two photos before and after, in the case of 80% reduction in volume, the clarity is almost the same, or a very powerful action, suitable for those warehouses that store more pictures.</p>`,12);function m(h,v){const e=o("ExternalLinkIcon");return i(),p("div",null,[s("p",null,[n("I maintain "),s("a",u,[n("awesome-github-profile-readme-chinese"),a(e)]),n(" The project aims to collect and summarize the excellent personal homepages in the Chinese area, and everyone's homepage will be stored in the exampls directory by taking screenshots, and sometimes some friends' homepages have a lot of content, so that the overall screenshot is very large.")]),r,s("p",null,[n("Used Actionsï¼š"),s("a",d,[n("image-actions"),a(e)])]),k])}const g=t(c,[["render",m],["__file","10-Automatic-lossless-compression-of-pictures-in-the-warehouse.html.vue"]]);export{g as default};
